(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/send_circle/index"],{"0276":function(e,t,i){"use strict";(function(e,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=s(i("ab35")),a=i("8c24");function s(e){return e&&e.__esModule?e:{default:e}}function c(e,t){return l(e)||d(e,t)||r()}function r(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function d(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var i=[],n=!0,o=!1,a=void 0;try{for(var s,c=e[Symbol.iterator]();!(n=(s=c.next()).done);n=!0)if(i.push(s.value),t&&i.length===t)break}catch(r){o=!0,a=r}finally{try{n||null==c["return"]||c["return"]()}finally{if(o)throw a}}return i}}function l(e){if(Array.isArray(e))return e}var g=function(){i.e("components/uni-grid").then(function(){return resolve(i("f931"))}.bind(null,i)).catch(i.oe)},u=function(){i.e("components/uni-popup").then(function(){return resolve(i("7594"))}.bind(null,i)).catch(i.oe)},f={components:{uniGrid:g,uniPopup:u},data:function(){return{scrollTop:0,old:{scrollTop:0},bottomData:[{text:"微信好友",icon:"",name:"wx"},{text:"朋友圈",icon:"",name:"wx"},{text:"发群",icon:"",name:"wx"}],title:"",type:"",comment:"",goodsItem:new Object,goodsById:new Object,sendCircleData:new Object,imgs:new Object,shareAdd:0,imgUrl:"",imgUrlOk:!1,page:1}},onShow:function(){e("log",n.getStorageSync("send_circle")," at pages\\send_circle\\index.vue:111"),n.getStorageSync("send_circle")&&(this.sendCircleData=this.sendCircleData.concat(n.getStorageSync("send_circle")),n.removeStorageSync("send_circle"))},onLoad:function(){this.getData()},methods:{touchmove:function(){var t=this;(0,a.getSendCircleData)({pageNo:this.page,pageSum:5}).then((function(i){if(100!=i.code){e("log",i.data," at pages\\send_circle\\index.vue:129");var n=i.data;for(var o in i.data){e("log",i.data[o].imgSrcs.split(",")," at pages\\send_circle\\index.vue:132");var a=[];for(var s in i.data[o].imgSrcs.split(",")){var c={image:i.data[o].imgSrcs.split(",")[s]};a.push(c)}n[o].imgSrcs=a}t.sendCircleData=t.sendCircleData.concat(n),t.page++,e("log",t.sendCircleData," at pages\\send_circle\\index.vue:145")}}))},detail:function(t){e("log",t," at pages\\send_circle\\index.vue:149"),n.navigateTo({url:"/pages/common/goods-detail?id=".concat(t,"&pageType=send_circle")})},togglePopup:function(t,i){var o=this;if(this.type=t,""!=t){(0,a.getGoodDetail)(i.goodsId,Number(this.getRelationId())).then((function(t){e("log",t," at pages\\send_circle\\index.vue:161"),o.goodsById=t.data})),this.goodsItem=i,e("log",i," at pages\\send_circle\\index.vue:165");var s="http://51atk.com:8009/html/openInstall/?invitecode="+n.getStorageSync("invitecode")+"&tkl="+i.tpwd+"&short_url="+i.short_url;(0,a.getShareImgUrl)({url:i.pict_url,CodeContent:s,TitleContent:i.title,NowPrice:i.zk_final_price,OldPrice:i.reserve_price,RedecePrice:i.youhuiquan,InvitationCode:n.getStorageSync("invitecode")}).then((function(t){o.imgUrlOk=!0,e("log",t," at pages\\send_circle\\index.vue:178"),o.imgUrl=t.imgUrl}))}},sendCircle:function(){(0,a.shareCount)({goodsId:this.goodsItem.goodsId,shareCount:1}).then((function(t){e("log","shareCount+1"," at pages\\send_circle\\index.vue:187")}))},getData:function(){var t=this;n.showLoading({title:"正在玩命加载..."}),(0,a.getSendCircleData)({pageNo:0}).then((function(i){for(var o in n.hideLoading(),e("log",JSON.stringify(i.data)," at pages\\send_circle\\index.vue:198"),t.sendCircleData=i.data,i.data){e("log",i.data[o].imgSrcs.split(",")," at pages\\send_circle\\index.vue:201");var a=[];for(var s in i.data[o].imgSrcs.split(",")){var c={image:i.data[o].imgSrcs.split(",")[s]};a.push(c)}t.sendCircleData[o].imgSrcs=a}e("log",t.sendCircleData," at pages\\send_circle\\index.vue:212")}))},getRelationId:function(){e("log",JSON.stringify(n.getStorageSync("user"))," at pages\\send_circle\\index.vue:216");try{return n.getStorageSync("user").pid}catch(t){e("log",t," at pages\\send_circle\\index.vue:220")}},copy:function(t){e("log",t," at pages\\send_circle\\index.vue:224"),(0,a.getGoodDetail)(t,Number(this.getRelationId())).then((function(t){e("log",t," at pages\\send_circle\\index.vue:226"),n.setClipboardData({data:"復制这段描述₳".concat(t.data.tpwd.substr(1,11),"₳,\n进入【Tao宝】即可抢购"),success:function(){n.showToast({title:"已复制"})}})}))},share:function(t){n.showLoading({title:"正在玩命加载...",mask:!0});var i=this;if(this.imgUrlOk)if(this.imgUrlOk=!1,"发群"==t){e("log",JSON.stringify(imgs)," at pages\\send_circle\\index.vue:259");var a=o.default.load(this.imgUrl,"image");a.then((function(t){var o=c(t,2),a=o[0],s=o[1];e("log",a,s," at pages\\send_circle\\index.vue:263"),n.hideLoading(),"saveImageToPhotosAlbum:ok"==s.errMsg&&n.showModal({content:"图片已保存至手机图库\n文案已自动复制",showCancel:!0,confirmText:"打开微信",success:function(t){t.confirm?(e("log","weixin"," at pages\\send_circle\\index.vue:272"),plus.runtime.openURL("weixin://dl/stickers"),i.shareAdd++,i.sendCircle()):i.type=""}})}))}else if("微信好友"==t){var s=[],r=this.goodsItem.imgSrcs;for(var d in r)s.push(r[d].image);if(e("log",JSON.stringify(s)," at pages\\send_circle\\index.vue:339"),this.goodsById){var l=0;e("log",this.goodsById," at pages\\send_circle\\index.vue:342"),l=this.goodsById.item_info.zk_final_price-this.goodsById.youhuiquan?(this.goodsById.item_info.zk_final_price-this.goodsById.youhuiquan).toFixed(2):this.goodsById.item_info.zk_final_price,this.goodsById.small_images=this.goodsById.item_info.small_images.string,this.goodsById.yj=(l*(this.goodsById.max_commission_rate/100)*.4).toFixed(2),e("log",this.goodsById.item_info.zk_final_price+"-"+this.goodsById.youhuiquan+"/"+this.goodsById.youhuiquan||0," at pages\\send_circle\\index.vue:350"),e("log",this.goodsById.max_commission_rate," at pages\\send_circle\\index.vue:351"),e("log",this.goodsById.yj," at pages\\send_circle\\index.vue:352"),this.copykey="復制这段描述₳".concat(this.goodsById.tpwd.substr(1,11),"₳,\n进入【Tao宝】即可抢购"),n.navigateTo({url:"/pages/common/share?id=".concat(this.goodsById.item_id,"&pict_url=").concat(this.goodsById.item_info.pict_url,"&youhuiquan=").concat(this.goodsById.youhuiquan,"&yj=,\n\t\t\t\t\t\t\t").concat(this.goodsById.yj,"&title=").concat(this.goodsById.item_info.title,"&zk_final_price=").concat(this.goodsById.item_info.zk_final_price,"&reserve_price=\n\t\t\t\t\t\t\t").concat(this.goodsById.item_info.reserve_price,"&small_images=").concat(this.goodsById.small_images,"&copykey=").concat(this.copykey,"&short_url=\n\t\t\t\t\t\t\t").concat(this.goodsById.short_url,"&invitecode=").concat(n.getStorageSync("invitecode"),"&yj=").concat(this.goodsById.yj,"&imgUrl=").concat(this.imgUrl,"&item_url=\n\t\t\t\t\t\t\t").concat(this.goodsById.item_url,"&description=").concat(this.goodsById.item_info.cat_leaf_name)})}n.hideLoading(),i.type=""}else if("朋友圈"==t){n.setClipboardData({data:this.goodsItem.title+"\n[原价]"+this.goodsItem.reserve_price+"\n[限时抢购]"+this.goodsItem.zk_final_price+"\n"+this.goodsItem.description,success:function(){}});var g=new Array;if(g=g.concat(this.goodsItem.imgSrcs),e("log",JSON.stringify(g)," at pages\\send_circle\\index.vue:417"),g.length>=1){for(var u in g){var f=o.default.load(g[u].image,u);u>=g.length-1&&f.then((function(t){var o=c(t,2),a=o[0],s=o[1];e("log",a,s," at pages\\send_circle\\index.vue:424"),n.hideLoading(),"saveImageToPhotosAlbum:ok"==s.errMsg&&n.showModal({content:"图片已保存至手机图库\n文案已自动复制",showCancel:!0,confirmText:"打开微信",success:function(t){t.confirm?(e("log","weixin"," at pages\\send_circle\\index.vue:434"),plus.runtime.openURL("weixin://"),i.shareAdd++,i.sendCircle(),i.type=""):i.type=""}})}))}return}}else"QQ好友"==t&&n.share({provider:"qq",type:2,imageUrl:this.shares.small_images[0],success:function(t){e("log","success:"+JSON.stringify(t)," at pages\\send_circle\\index.vue:486")},fail:function(t){e("log","fail:"+JSON.stringify(t)," at pages\\send_circle\\index.vue:489")}});else n.showToast({title:"图片正在生成...",icon:"none"})}}};t.default=f}).call(this,i("0de9")["default"],i("6e42")["default"])},2963:function(e,t,i){"use strict";var n,o=function(){var e=this,t=e.$createElement;e._self._c},a=[];i.d(t,"b",(function(){return o})),i.d(t,"c",(function(){return a})),i.d(t,"a",(function(){return n}))},"34b2":function(e,t,i){},"5d90":function(e,t,i){"use strict";i.r(t);var n=i("0276"),o=i.n(n);for(var a in n)"default"!==a&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t["default"]=o.a},"5e91":function(e,t,i){"use strict";(function(e){i("00a9"),i("921b");n(i("66fd"));var t=n(i("e847"));function n(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,i("6e42")["createPage"])},"909e":function(e,t,i){"use strict";var n=i("34b2"),o=i.n(n);o.a},e847:function(e,t,i){"use strict";i.r(t);var n=i("2963"),o=i("5d90");for(var a in o)"default"!==a&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("909e");var s,c=i("f0c5"),r=Object(c["a"])(o["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],s);t["default"]=r.exports}},[["5e91","common/runtime","common/vendor"]]]);