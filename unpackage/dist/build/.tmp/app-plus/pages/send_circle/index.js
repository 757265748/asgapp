(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/send_circle/index"],{"0276":function(e,t,n){"use strict";(function(e,i){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n("ab35")),a=n("8c24");function r(e){return e&&e.__esModule?e:{default:e}}function c(e,t){return g(e)||u(e,t)||l(e,t)||s()}function s(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function l(e,t){if(e){if("string"===typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(e,t):void 0}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function u(e,t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e)){var n=[],i=!0,o=!1,a=void 0;try{for(var r,c=e[Symbol.iterator]();!(i=(r=c.next()).done);i=!0)if(n.push(r.value),t&&n.length===t)break}catch(s){o=!0,a=s}finally{try{i||null==c["return"]||c["return"]()}finally{if(o)throw a}}return n}}function g(e){if(Array.isArray(e))return e}var f=function(){n.e("components/uni-grid").then(function(){return resolve(n("f931"))}.bind(null,n)).catch(n.oe)},p=function(){n.e("components/uni-popup/uni-popup").then(function(){return resolve(n("929b"))}.bind(null,n)).catch(n.oe)},h={components:{uniGrid:f,uniPopup:p},data:function(){return{scrollTop:0,old:{scrollTop:0},bottomData:[{text:"微信好友",icon:"https://img-cdn-qiniu.dcloud.net.cn/uni-ui/grid-2.png",name:"wx"},{text:"朋友圈",icon:"../../static/share/pyq.png",name:"pyq"},{text:"发群",icon:"https://img-cdn-qiniu.dcloud.net.cn/uni-ui/grid-9.png",name:"fq"}],title:"",type:"",comment:"",goodsItem:new Object,goodsById:new Object,sendCircleData:new Object,imgs:new Object,shareAdd:0,imgUrl:"",imgUrlOk:!1,page:1}},onShow:function(){e.hideLoading(),i("log",e.getStorageSync("send_circle")," at pages\\send_circle\\index.vue:134"),e.getStorageSync("send_circle")&&(this.sendCircleData=this.sendCircleData.concat(e.getStorageSync("send_circle")),e.removeStorageSync("send_circle"))},onBackPress:function(){this.$refs["showshare"].close()},onLoad:function(){this.getData()},methods:{scroll:function(e){i("log",e," at pages\\send_circle\\index.vue:148"),this.old.scrollTop=e.detail.scrollTop},loadMore:function(){var e=this;i("log",111," at pages\\send_circle\\index.vue:152"),(0,a.getSendCircleData)({pageNo:this.page,pageSum:5}).then((function(t){if(100!=t.code){i("log",t.data," at pages\\send_circle\\index.vue:160");var n=t.data;for(var o in t.data){i("log",t.data[o].imgSrcs.split(",")," at pages\\send_circle\\index.vue:163");var a=[];for(var r in t.data[o].imgSrcs.split(",")){var c={image:t.data[o].imgSrcs.split(",")[r]};a.push(c)}n[o].imgSrcs=a}e.sendCircleData=e.sendCircleData.concat(n),e.page++,i("log",e.sendCircleData," at pages\\send_circle\\index.vue:176")}}))},detail:function(t){i("log",t," at pages\\send_circle\\index.vue:180"),e.navigateTo({url:"/pages/common/goods-detail?id=".concat(t,"&pageType=send_circle")})},cancel:function(e){this.$refs["show"+e].close()},change:function(e){i("log","是否打开:"+e.show," at pages\\send_circle\\index.vue:190")},togglePopup:function(t,n,o){var r=this;if(this.type=t,this.$nextTick((function(){r.$refs["show"+n].open()})),""!=t){(0,a.getGoodDetail)(o.goodsId,Number(this.getRelationId())).then((function(e){i("log",e," at pages\\send_circle\\index.vue:201"),r.goodsById=e.data})),this.goodsItem=o,i("log",o," at pages\\send_circle\\index.vue:205");var c="http://51atk.com:8009/html/openInstall/?invitecode="+e.getStorageSync("invitecode")+"&tkl="+o.tpwd+"&short_url="+o.short_url;(0,a.getShareImgUrl)({url:o.pict_url,CodeContent:c,TitleContent:o.title,NowPrice:o.zk_final_price,OldPrice:o.reserve_price,RedecePrice:o.youhuiquan,InvitationCode:e.getStorageSync("invitecode")}).then((function(e){r.imgUrlOk=!0,i("log",e," at pages\\send_circle\\index.vue:218"),r.imgUrl=e.imgUrl}))}},sendCircle:function(){(0,a.shareCount)({goodsId:this.goodsItem.goodsId,shareCount:1}).then((function(e){i("log","shareCount+1"," at pages\\send_circle\\index.vue:227")}))},getData:function(){var t=this;e.showLoading({title:"正在玩命加载..."}),(0,a.getSendCircleData)({pageNo:0}).then((function(n){for(var o in e.hideLoading(),i("log",JSON.stringify(n.data)," at pages\\send_circle\\index.vue:238"),t.sendCircleData=n.data,n.data){i("log",n.data[o].imgSrcs.split(",")," at pages\\send_circle\\index.vue:241");var a=[];for(var r in n.data[o].imgSrcs.split(",")){var c={image:n.data[o].imgSrcs.split(",")[r]};a.push(c)}t.sendCircleData[o].imgSrcs=a}i("log",t.sendCircleData," at pages\\send_circle\\index.vue:252")}))},getRelationId:function(){i("log",JSON.stringify(e.getStorageSync("user"))," at pages\\send_circle\\index.vue:256");try{return e.getStorageSync("user").pid}catch(t){i("log",t," at pages\\send_circle\\index.vue:260")}},copy:function(t){i("log",t," at pages\\send_circle\\index.vue:264"),(0,a.getGoodDetail)(t,Number(this.getRelationId())).then((function(t){i("log",t," at pages\\send_circle\\index.vue:266"),e.setClipboardData({data:"復制这段描述₳".concat(t.data.tpwd.substr(1,11),"₳,\n进入【Tao宝】即可抢购"),success:function(){e.showToast({title:"已复制"})}})}))},share:function(t){e.showLoading({title:"请稍等...",mask:!0});var n=this;if(this.imgUrlOk)if(this.imgUrlOk=!1,"发群"==t){i("log",JSON.stringify(imgs)," at pages\\send_circle\\index.vue:301");var a=o.default.load(this.imgUrl,"image");a.then((function(t){var o=c(t,2),a=o[0],r=o[1];i("log",a,r," at pages\\send_circle\\index.vue:305"),e.hideLoading(),"saveImageToPhotosAlbum:ok"==r.errMsg&&e.showModal({content:"图片已保存至手机图库\n文案已自动复制",showCancel:!0,confirmText:"打开微信",success:function(e){e.confirm?(i("log","weixin"," at pages\\send_circle\\index.vue:314"),plus.runtime.openURL("weixin://dl/stickers"),n.shareAdd++,n.sendCircle()):n.type=""}})}))}else if("微信好友"==t)n.type="",e.share({provider:"weixin",scene:"WXSceneSession",type:2,imageUrl:this.imgUrl,success:function(e){i("log","success:"+JSON.stringify(e)," at pages\\send_circle\\index.vue:334")},fail:function(e){i("log","fail:"+JSON.stringify(e)," at pages\\send_circle\\index.vue:337")}});else if("朋友圈"==t){e.setClipboardData({data:this.goodsItem.title+"\n[原价]"+this.goodsItem.reserve_price+"\n[限时抢购]"+this.goodsItem.zk_final_price+"\n"+this.goodsItem.description,success:function(){}});var r=new Array;if(r=r.concat(this.goodsItem.imgSrcs),i("log",JSON.stringify(r)," at pages\\send_circle\\index.vue:373"),r.length>=1){for(var s in r){var l=o.default.load(r[s].image,s);s>=r.length-1&&l.then((function(t){var o=c(t,2),a=o[0],r=o[1];i("log",a,r," at pages\\send_circle\\index.vue:380"),e.hideLoading(),"saveImageToPhotosAlbum:ok"==r.errMsg&&e.showModal({content:"图片已保存至手机图库\n文案已自动复制",showCancel:!0,confirmText:"打开微信",success:function(e){e.confirm?(i("log","weixin"," at pages\\send_circle\\index.vue:390"),plus.runtime.openURL("weixin://"),n.shareAdd++,n.sendCircle(),n.type=""):n.type=""}})}))}return}}else"QQ好友"==t&&e.share({provider:"qq",type:2,imageUrl:this.shares.small_images[0],success:function(e){i("log","success:"+JSON.stringify(e)," at pages\\send_circle\\index.vue:442")},fail:function(e){i("log","fail:"+JSON.stringify(e)," at pages\\send_circle\\index.vue:445")}});else e.showToast({title:"图片正在生成...",icon:"none"})}}};t.default=h}).call(this,n("6e42")["default"],n("0de9")["default"])},5144:function(e,t,n){},"5d90":function(e,t,n){"use strict";n.r(t);var i=n("0276"),o=n.n(i);for(var a in i)"default"!==a&&function(e){n.d(t,e,(function(){return i[e]}))}(a);t["default"]=o.a},"5e91":function(e,t,n){"use strict";(function(e){n("00a9"),n("921b");i(n("66fd"));var t=i(n("e847"));function i(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,n("6e42")["createPage"])},"909e":function(e,t,n){"use strict";var i=n("5144"),o=n.n(i);o.a},bf6b:function(e,t,n){"use strict";var i={"uni-popup":function(){return n.e("components/uni-popup/uni-popup").then(n.bind(null,"929b"))}},o=function(){var e=this,t=e.$createElement;e._self._c},a=[];n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return i}))},e847:function(e,t,n){"use strict";n.r(t);var i=n("bf6b"),o=n("5d90");for(var a in o)"default"!==a&&function(e){n.d(t,e,(function(){return o[e]}))}(a);n("909e");var r,c=n("f0c5"),s=Object(c["a"])(o["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],r);t["default"]=s.exports}},[["5e91","common/runtime","common/vendor"]]]);