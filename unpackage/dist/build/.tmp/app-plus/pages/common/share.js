(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/common/share"],{"1eb0":function(e,t,s){},"2eb3":function(e,t,s){"use strict";var o=s("1eb0"),a=s.n(o);a.a},5517:function(e,t,s){"use strict";(function(e,o){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=i(s("ab35")),n=s("8c24");function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){return g(e)||l(e,t)||h(e,t)||c()}function c(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function h(e,t){if(e){if("string"===typeof e)return u(e,t);var s=Object.prototype.toString.call(e).slice(8,-1);return"Object"===s&&e.constructor&&(s=e.constructor.name),"Map"===s||"Set"===s?Array.from(s):"Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?u(e,t):void 0}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var s=0,o=new Array(t);s<t;s++)o[s]=e[s];return o}function l(e,t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e)){var s=[],o=!0,a=!1,n=void 0;try{for(var i,r=e[Symbol.iterator]();!(o=(i=r.next()).done);o=!0)if(s.push(i.value),t&&s.length===t)break}catch(c){a=!0,n=c}finally{try{o||null==r["return"]||r["return"]()}finally{if(a)throw n}}return s}}function g(e){if(Array.isArray(e))return e}function m(e,t){var s,o={"Y+":t.getFullYear().toString(),"m+":(t.getMonth()+1).toString(),"d+":t.getDate().toString(),"H+":t.getHours().toString(),"M+":t.getMinutes().toString(),"S+":t.getSeconds().toString()};for(var a in o)s=new RegExp("("+a+")").exec(e),s&&(e=e.replace(s[1],1==s[1].length?o[a]:o[a].padStart(s[1].length,"0")));return e}var p=function(){s.e("components/uni-popup/uni-popup").then(function(){return resolve(s("929b"))}.bind(null,s)).catch(s.oe)},d={components:{uniPopup:p},onShow:function(){e.hideLoading()},onLoad:function(t){this.id=t.id,o("log",1111," at pages\\common\\share.vue:111"),o("log",e.getStorageSync("user").invitecode," at pages\\common\\share.vue:112"),o("log",t," at pages\\common\\share.vue:113"),this.shares=t,this.shares.small_images=this.shares.small_images.split(","),o("log",this.shares.small_images," at pages\\common\\share.vue:116"),o("log","http://39.108.215.49:8009/"+e.getStorageSync("user").invitecode+"/"+e.getStorageSync("user").invitecode+".png"," at pages\\common\\share.vue:117"),e.getSystemInfo({success:function(t){o("log",t.windowWidth," at pages\\common\\share.vue:120");var s=e.createSelectorQuery().select("#stone");s.boundingClientRect((function(e){o("log",e," at pages\\common\\share.vue:123")})).exec()}}),this.imgs.push(this.shares.imgUrl)},data:function(){return{shares:new Object,heightH:e.getSystemInfoSync().windowHeight,type:"",id:"",shareCount:0,shareImg:!1,bottomData:[{text:"微信好友",icon:"https://img-cdn-qiniu.dcloud.net.cn/uni-ui/grid-2.png",name:"wx"},{text:"朋友圈",icon:"../../static/share/pyq.png",name:"pyq"},{text:"发圈",icon:"https://img-cdn-qiniu.dcloud.net.cn/uni-ui/grid-4.png",name:"fq"}],tklShow:!1,syShow:!1,yqmShow:!1,linkShow:!1,imgDownloads:[!1,!1,!1,!1],imgs:[]}},onBackPress:function(t){e.setStorageSync("webview",!0),this.$refs["showshare"].close()},methods:{bindTextAreaBlur:function(e){this.shares.title=e.detail.value,o("log",e.detail.value," at pages\\common\\share.vue:171")},checkboxChange:function(e,t,s){"sy"==e?this.syShow=!this.syShow:"yqm"==e?this.yqmShow=!this.yqmShow:"link"==e?this.linkShow=!this.linkShow:"tkl"==e?this.tklShow=!this.tklShow:(this.imgDownloads[s]=!this.imgDownloads[s],1==this.imgDownloads[s]?(o("log",this.imgDownloads[s]," at pages\\common\\share.vue:186"),this.imgs.push(t),o("log",this.imgs," at pages\\common\\share.vue:188"),this.imgDownloads[s]=!1):(o("log",this.imgDownloads[s]," at pages\\common\\share.vue:191"),this.imgs.splice(s,1),o("log",this.imgs," at pages\\common\\share.vue:193")))},togglePopup:function(e,t){var s=this;o("log",e," at pages\\common\\share.vue:198"),this.type=e,this.$nextTick((function(){s.$refs["show"+t].open()}))},cancel:function(e){this.$refs["show"+e].close()},change:function(e){o("log","是否打开:"+e.show," at pages\\common\\share.vue:208")},copykey:function(t){if("tkl"==t)e.setClipboardData({data:this.shares.copykey,success:function(){e.showToast({title:"已复制"})}});else if("link"==t)e.setClipboardData({data:this.shares.item_url,success:function(){e.showToast({title:"已复制"})}});else if("wa"==t){o("log",this.shares.title," at pages\\common\\share.vue:231");var s=this.shares.title+"\n[原价] "+this.shares.zk_final_price+"\n[券后价] "+this.shares.reserve_price;o("log",this.syShow," at pages\\common\\share.vue:233"),o("log",this.yqmShow," at pages\\common\\share.vue:234"),o("log",this.linkShow," at pages\\common\\share.vue:235"),this.syShow&&(o("log",0," at pages\\common\\share.vue:237"),s+="\n[用爱省购再省] "+this.shares.yj),this.yqmShow&&(o("log",1," at pages\\common\\share.vue:240"),s+="\n[邀请码] "+this.shares.invitecode),this.linkShow&&(o("log",2," at pages\\common\\share.vue:243"),s+="\n[商品链接]\n"+this.shares.item_url),this.tklShow&&(o("log",3," at pages\\common\\share.vue:246"),s+="\n[淘口令]\n"+this.shares.copykey),e.setClipboardData({data:s,success:function(){e.showToast({title:"已复制"})}})}},saveImg:function(t,s){var n=this,i=new Array;for(var c in this.shares.small_images)o("log",this.shares.small_images[c]," at pages\\common\\share.vue:263"),i.push(this.shares.small_images[c]);if(n.type="",i.length>=1)for(var h in o("log",i.length," at pages\\common\\share.vue:281"),i){o("log",i[h]," at pages\\common\\share.vue:283");var u=a.default.load(i[h],"img"+h);h>=i.length-1&&(o("log",h," at pages\\common\\share.vue:286"),u.then((function(t){var s=r(t,2),a=s[0],i=s[1];o("log",a,i," at pages\\common\\share.vue:288"),e.hideLoading(),"saveImageToPhotosAlbum:ok"==i.errMsg&&e.showModal({content:"图片已保存至手机图库\n文案已自动复制",showCancel:!0,confirmText:"打开微信",success:function(e){e.confirm?(plus.runtime.openURL("weixin://"),n.shareAdd++,n.sendCircle(),n.type=""):n.type=""}})})))}else;},share:function(t){var s=this;e.showLoading({title:"请稍等...",mask:!0});var a=this;"微信好友"==t?(a.type="",e.share({provider:"weixin",scene:"WXSceneSession",type:2,imageUrl:this.shares.imgUrl,success:function(e){o("log","success:"+JSON.stringify(e)," at pages\\common\\share.vue:387"),a.shareAdd++,a.sendCircle()},fail:function(e){o("log","fail:"+JSON.stringify(e)," at pages\\common\\share.vue:392")},complete:function(){e.hideLoading()}})):"朋友圈"==t?this.saveImg("WXSenceTimeline",0):"QQ好友"==t?e.share({provider:"qq",type:2,imageUrl:this.shares.small_images[0],success:function(e){o("log","success:"+JSON.stringify(e)," at pages\\common\\share.vue:461")},fail:function(e){o("log","fail:"+JSON.stringify(e)," at pages\\common\\share.vue:464")}}):"发圈"==t&&(0,n.sendCircleExisit)({goodsId:this.id}).then((function(t){if(e.hideLoading(),o("log",s.id," at pages\\common\\share.vue:472"),o("log",t.data," at pages\\common\\share.vue:473"),t.data.length>0)e.showToast({title:"该商品已经发过圈啦 ！",icon:"none"});else{var a=[];o("log",s.shares.small_images," at pages\\common\\share.vue:488");var i=s.shares.small_images;for(var r in i){o("log",i[r]," at pages\\common\\share.vue:491");var c={image:i[r]};a.push(c)}var h={title:s.shares.title,pict_url:s.shares.pict_url,reserve_price:s.shares.reserve_price,zk_final_price:s.shares.zk_final_price,youhuiquan:s.shares.youhuiquan,imgSrcs:a,shareCount:s.shareCount,goodsId:s.id,comment:s.shares.copykey,invitecode:s.shares.invitecode,short_url:s.shares.short_url,yj:s.shares.yj,create_date:"刚刚",create_user:e.getStorageSync("user").username,create_user_sex:e.getStorageSync("user").sex};o("log",h," at pages\\common\\share.vue:515"),e.setStorageSync("send_circle",h),(0,n.addSendCircle)({title:s.shares.title,pict_url:s.shares.pict_url,reserve_price:s.shares.reserve_price,zk_final_price:s.shares.zk_final_price,youhuiquan:s.shares.youhuiquan,imgSrcs:s.shares.small_images.join(","),shareCount:s.shareCount,goodsId:s.id,comment:s.shares.copykey,invitecode:s.shares.invitecode,short_url:s.shares.short_url,description:s.shares.description,yj:s.shares.yj,create_date:m("YYYY-mm-dd HH:MM:SS",new Date),create_user:e.getStorageSync("user").username,create_user_sex:e.getStorageSync("user").sex}).then((function(t){o("log",t," at pages\\common\\share.vue:535"),200==t.data.code&&e.showToast({title:"发圈成功！"})}))}}))}}};t.default=d}).call(this,s("6e42")["default"],s("0de9")["default"])},be64:function(e,t,s){"use strict";var o={"uni-popup":function(){return s.e("components/uni-popup/uni-popup").then(s.bind(null,"929b"))}},a=function(){var e=this,t=e.$createElement;e._self._c},n=[];s.d(t,"b",(function(){return a})),s.d(t,"c",(function(){return n})),s.d(t,"a",(function(){return o}))},c42c:function(e,t,s){"use strict";(function(e){s("00a9"),s("921b");o(s("66fd"));var t=o(s("d216"));function o(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,s("6e42")["createPage"])},d216:function(e,t,s){"use strict";s.r(t);var o=s("be64"),a=s("d481");for(var n in a)"default"!==n&&function(e){s.d(t,e,(function(){return a[e]}))}(n);s("2eb3");var i,r=s("f0c5"),c=Object(r["a"])(a["default"],o["b"],o["c"],!1,null,"0b11b4b9",null,!1,o["a"],i);t["default"]=c.exports},d481:function(e,t,s){"use strict";s.r(t);var o=s("5517"),a=s.n(o);for(var n in o)"default"!==n&&function(e){s.d(t,e,(function(){return o[e]}))}(n);t["default"]=a.a}},[["c42c","common/runtime","common/vendor"]]]);