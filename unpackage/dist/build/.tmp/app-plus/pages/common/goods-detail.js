(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/common/goods-detail"],{"131f":function(t,e,o){"use strict";var n={"uni-popup":function(){return o.e("components/uni-popup/uni-popup").then(o.bind(null,"929b"))}},i=function(){var t=this,e=t.$createElement;t._self._c},a=[];o.d(e,"b",(function(){return i})),o.d(e,"c",(function(){return a})),o.d(e,"a",(function(){return n}))},"2b95":function(t,e,o){"use strict";(function(t,n){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=s(o("4795")),a=o("8c24");o("61d4");function s(t){return t&&t.__esModule?t:{default:t}}function c(t,e){return g(t)||d(t,e)||r(t,e)||l()}function l(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function r(t,e){if(t){if("string"===typeof t)return u(t,e);var o=Object.prototype.toString.call(t).slice(8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Array.from(o):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?u(t,e):void 0}}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var o=0,n=new Array(e);o<e;o++)n[o]=t[o];return n}function d(t,e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t)){var o=[],n=!0,i=!1,a=void 0;try{for(var s,c=t[Symbol.iterator]();!(n=(s=c.next()).done);n=!0)if(o.push(s.value),e&&o.length===e)break}catch(l){i=!0,a=l}finally{try{n||null==c["return"]||c["return"]()}finally{if(i)throw a}}return o}}function g(t){if(Array.isArray(t))return t}function h(t,e,o,n,i,a,s){try{var c=t[a](s),l=c.value}catch(r){return void o(r)}c.done?e(l):Promise.resolve(l).then(n,i)}function p(t){return function(){var e=this,o=arguments;return new Promise((function(n,i){var a=t.apply(e,o);function s(t){h(a,n,i,s,c,"next",t)}function c(t){h(a,n,i,s,c,"throw",t)}s(void 0)}))}}var m=function(){o.e("components/uni-icon").then(function(){return resolve(o("96b7"))}.bind(null,o)).catch(o.oe)},f=function(){o.e("components/product-list").then(function(){return resolve(o("c398"))}.bind(null,o)).catch(o.oe)},v=function(){o.e("components/other/uni-section/uni-section").then(function(){return resolve(o("d875"))}.bind(null,o)).catch(o.oe)},_=function(){o.e("components/other/uni-collapse/uni-collapse").then(function(){return resolve(o("be22"))}.bind(null,o)).catch(o.oe)},y=function(){o.e("components/other/uni-collapse-item/uni-collapse-item").then(function(){return resolve(o("6bb1"))}.bind(null,o)).catch(o.oe)},b=function(){o.e("components/other/uni-list/uni-list").then(function(){return resolve(o("165d"))}.bind(null,o)).catch(o.oe)},w=function(){o.e("components/other/uni-list-item/uni-list-item").then(function(){return resolve(o("849c"))}.bind(null,o)).catch(o.oe)},S=function(){o.e("components/uni-popup").then(function(){return resolve(o("7594"))}.bind(null,o)).catch(o.oe)},T=function(){o.e("components/ahh5-animated/ahh5-animated").then(function(){return resolve(o("d307"))}.bind(null,o)).catch(o.oe)};Date.prototype.format=function(t){var e={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};for(var o in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),e)new RegExp("("+o+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?e[o]:("00"+e[o]).substr((""+e[o]).length)));return t};var x={props:{isSE:{type:Boolean,default:!1},presale:String},computed:{qhj:function(){var t=0;return t=this.good.item_info.zk_final_price-this.good.youhuiquan>0?(this.good.item_info.zk_final_price-this.good.youhuiquan).toFixed(2):this.good.item_info.zk_final_price,t}},components:{productList:f,uniSection:v,uniCollapse:_,uniCollapseItem:y,uniList:b,uniListItem:w,uniPopup:S,uniIcon:m,Ahh5Animated:T},data:function(){return{changSwiperIndex:0,Ahh5Animated:[{key:"Fading Entrances",data:["fadeInDown"]}],title:"0",indicatorDots:!1,autoplay:!1,previousMargin:t.upx2px(152)+"px",nextMargin:t.upx2px(152)+"px",circular:!0,zoomParam:1.1,swiperCurrentIndex:0,data:[],max:0,pt:"",type:"",bottomData:[{text:"微信好友",icon:"",name:"wx"},{text:"朋友圈",icon:"",name:"wx"},{text:"发圈",icon:"",name:"fq"}],nowScrollTop:0,isCollection:!1,collentionColor:"#fff",table:"",page:1,id:"",scrolltop:0,scrollFlag:!1,navisShow:!0,isactive:!0,reprice:15,copykey:"",url:"",good:null,detailImgs:[],goodObj:{small_images:null,zk_final_price:null,reserve_price:null,volume:null,title:"",short_url:"",item_description:"",jy:null,pict_url:"",num_iid:"",item_url:""},recommend:[],collect:[],detail:null,phone:this.getUser(),webview:t.getStorageSync("webview"),pageType:"",collectFlag:!1}},onLoad:function(e){n("log",e," at pages\\common\\goods-detail.vue:351");var o=e.id||"";this.id=Number(o),n("log",this.id," at pages\\common\\goods-detail.vue:354"),n("log",typeof this.id," at pages\\common\\goods-detail.vue:355");e.table;var i=e.page||"";this.isSE=e.isSE||!1,this.presale=e.presale,this.page=i,this.pageType=e.pageType||"",n("log",e.isSE," at pages\\common\\goods-detail.vue:362");this._getPid();this._getData(this.id),t.setStorageSync("webview",!1),this.loadTBKgoodsInfo(this.id)},onShow:function(){this.existUser(),this.select_collect()},onBackPress:function(e){n("log",e," at pages\\common\\goods-detail.vue:373"),"backbutton"==e.from&&("send_circle"==this.pageType?t.switchTab({url:"/pages/send_circle/index"}):t.switchTab({url:"/pages/index/index"}))},onPullDownRefresh:function(e){this.collectFlag=!0,t.stopPullDownRefresh()},methods:{center_store:function(t){(0,a.getTbkShop)({keyword:t}).then((function(t){n("log",t," at pages\\common\\goods-detail.vue:396"),200==t.code&&(n("log",t.result[0].shop_url," at pages\\common\\goods-detail.vue:398"),plus.runtime.openURL(t.result[0].shop_url))}))},collect_good_detail:function(e){n("log",e," at pages\\common\\goods-detail.vue:405"),t.navigateTo({url:"/pages/common/goods-detail?id=".concat(e.item_id)})},global_tap:function(){this.collectFlag=!1},collect_tap:function(t){return n("log",JSON.stringify(t)," at pages\\common\\goods-detail.vue:416"),this.collectFlag=!0,!1},swiperChange:function(t){n("log",t," at pages\\common\\goods-detail.vue:421"),this.changSwiperIndex=t.detail.current},select_collect:function(){var e=this;(0,a.select_collect)({user_id:t.getStorageSync("user").id}).then((function(o){n("log",o," at pages\\common\\goods-detail.vue:429"),200==o.code?e.collect=o.result:t.showToast({title:o.msg,icon:"none"})}))},insert_collect:function(t){(0,a.insert_collect)({item_id:t.item_id,user_id:t.user_id,pict_url:t.pict_url,title:t.title,price:t.price,create_date:t.create_date}).then((function(t){n("log",t," at pages\\common\\goods-detail.vue:450")}))},loadTBKgoodsInfo:function(e){var o=this;return p(i.default.mark((function a(){var s,l,r,u,d,g,h,p,m,f;return i.default.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return(new Date).getTime(),i.next=3,t.request({url:"https://h5api.m.taobao.com/h5/mtop.taobao.detail.getdesc/6.0",method:"GET",header:{"content-type":"application/json;charset=UTF-8"},data:{data:'{"id":"'+e+'"}',_:(new Date).getTime()}});case 3:if(s=i.sent,l=c(s,2),l[0],r=l[1],200==r.statusCode){for(u=r.data.data.pcDescContent||{},d=u.match(/<img.*?(?:>|\/>)/gi),g=/src=[\'\"]?([^\'\"]*)[\'\"]?/i,h=[],p=1;p<d.length;p++)m=d[p].match(g),m[1]&&(f=m[1],"http://"==f.substr(0,7).toLowerCase()&&"https://"==f.substr(0,8).toLowerCase()||(f="http://"+f),h.push(f));n("log","loadTBKgoodsInfo==>获取商品详情",h," at pages\\common\\goods-detail.vue:486"),h.length>0&&(o.detailImgs=h,n("log",e," at pages\\common\\goods-detail.vue:489"),n("log",o.detailImgs," at pages\\common\\goods-detail.vue:490"))}case 8:case"end":return i.stop()}}),a)})))()},togglePopup:function(t){this.type=t},_getPid:function(){try{var e=t.getStorageSync("user");return e.pid}catch(o){}},getUser:function(){try{var e=t.getStorageSync("user");return e.phone}catch(o){n("log",o," at pages\\common\\goods-detail.vue:511")}},getRelationId:function(){n("log",JSON.stringify(t.getStorageSync("user"))," at pages\\common\\goods-detail.vue:515");try{return t.getStorageSync("user").pid}catch(e){n("log",e," at pages\\common\\goods-detail.vue:519")}},getPhone:function(){try{return t.getStorageSync("user").phone}catch(e){n("log",e," at pages\\common\\goods-detail.vue:526")}},copyTpwd:function(e){"tkl"==e?t.setClipboardData({data:this.good.tpwd,success:function(){t.showToast({title:"已复制"})}}):"link"==e?t.setClipboardData({data:this.good.tpwd,success:function(){t.showToast({title:"已复制"})}}):"title"==e&&t.setClipboardData({data:this.good.item_info.title,success:function(){t.showToast({title:"已复制"})}})},collection:function(){var e=this;this.phone?this.isCollection?(n("log","取消收藏",this.isCollection," at pages\\common\\goods-detail.vue:570"),this.collentionColor="#fff",(0,a.deleteCollection)({phone:this.phone,num_iid:this.good.num_iid}).then((function(o){e.isCollection=!1,t.showToast({title:"已取消"})}))):this.isCollection||(n("log","增加收藏",this.isCollection," at pages\\common\\goods-detail.vue:582"),this.collentionColor="#ff0000",(0,a.addCollection)({phone:this.phone,volume:this.good.item_info.volume,quanhoujia:this.good.item_info.reserve_price,youhuiquan:this.good.youhuiquan||0,zk_final_price:this.good.item_info.zk_final_price,title:this.good.item_info.title,pict_url:this.good.item_info.pict_url,num_iid:this.id}).then((function(o){n("log",o," at pages\\common\\goods-detail.vue:596"),n("log","已收藏"," at pages\\common\\goods-detail.vue:597"),e.isCollection=!0,t.showToast({title:"已收藏"})}))):t.showToast({title:"未登录",icon:"none"})},share:function(e){var o=this;if(this.phone){n("log",JSON.stringify(this.good)," at pages\\common\\goods-detail.vue:614"),n("log",JSON.stringify(this.good.small_images)," at pages\\common\\goods-detail.vue:615"),n("log",this.good.small_images," at pages\\common\\goods-detail.vue:616"),t.setStorageSync("webview",!0);var i=this.good.tpwd.substr(1,this.good.tpwd.length-2),s="http://51atk.com:8009/html/openInstall/?invitecode="+t.getStorageSync("invitecode")+"&tkl="+i+"&short_url="+this.good.short_url;n("log",i," at pages\\common\\goods-detail.vue:621"),(0,a.getShareImgUrl)({url:this.good.item_info.pict_url,CodeContent:s,TitleContent:this.good.item_info.title,NowPrice:this.good.item_info.zk_final_price,OldPrice:this.good.item_info.reserve_price,RedecePrice:this.good.youhuiquan,InvitationCode:t.getStorageSync("invitecode")}).then((function(e){n("log",JSON.stringify(e)," at pages\\common\\goods-detail.vue:637"),o.url="http://39.108.215.49:8009/html/getShareImgUrl.html?url="+o.goodObj.pict_url+"&CodeContent="+s+"&TitleContent="+o.goodObj.title+"&NowPrice="+o.goodObj.zk_final_price+"&OldPrice="+o.goodObj.reserve_price+"&RedecePrice="+o.good.youhuiquan+"&InvitationCode="+t.getStorageSync("invitecode")+"&title="+o.goodObj.title+"&zk_final_price="+o.goodObj.zk_final_price+"&reserve_price="+o.goodObj.reserve_price+"&item_url="+o.goodObj.item_url+"&copykey="+o.copykey+"&yj1="+o.goodObj.yj,o.copykey="復制这段描述₳".concat(o.good.tpwd.substr(1,11),"₳,\n进入【Tao宝】即可抢购"),n("log",o.url," at pages\\common\\goods-detail.vue:650"),t.navigateTo({url:"share?id=".concat(o.id,"&pict_url=").concat(o.good.item_info.pict_url,"&youhuiquan=").concat(o.good.youhuiquan,"&yj=").concat(o.good.yj,"&title=").concat(o.good.item_info.title,"&zk_final_price=").concat(o.good.item_info.zk_final_price,"&reserve_price=").concat(o.good.item_info.reserve_price,"&small_images=").concat(o.good.small_images,"&copykey=").concat(o.copykey,"&short_url=").concat(o.good.short_url,"&invitecode=").concat(t.getStorageSync("user").invitecode,"&imgUrl=").concat(e.imgUrl,"&item_url=").concat(o.good.item_url,"&description=").concat(o.good.item_info.cat_leaf_name)})}))}else t.showToast({title:"未登录",icon:"none"})},existUser:function(){var e=this;(0,a.existUser)(this.phone).then((function(o){200!=o.data.code&&(t.showToast({title:"未登录!",icon:"none"}),e.phone=null)}))},jump:function(e){if(this.phone){n("log",e," at pages\\common\\goods-detail.vue:688");var o=e.slice(8);n("log","taobao://".concat(o)," at pages\\common\\goods-detail.vue:690"),plus.runtime.openURL("taobao://".concat(o)),n("log","url:"+e," at pages\\common\\goods-detail.vue:692")}else t.showToast({title:"未登录",icon:"none"})},recod:function(){var t=this;(0,a.getItemsDes)(this.id).then((function(e){n("log",t.id," at pages\\common\\goods-detail.vue:696")}))},getDetailImgs:function(e){return p(i.default.mark((function o(){return i.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return o.abrupt("return",new Promise((function(o,i){t.request({url:e,success:function(t){n("log",JSON.stringify(t.data.data.pcDescContent)," at pages\\common\\goods-detail.vue:705"),o(t.data)},fail:function(t){n("log",t," at pages\\common\\goods-detail.vue:709")}})})));case 1:case"end":return o.stop()}}),o)})))()},regexpDetail:function(t){if(200==res.statusCode){for(var e=res.data.data.pcDescContent||{},o=e.match(/<img.*?(?:>|\/>)/gi),i=/src=[\'\"]?([^\'\"]*)[\'\"]?/i,a=[],s=1;s<o.length;s++){var c=o[s].match(i);if(c[1]){var l=c[1];"http://"==l.substr(0,7).toLowerCase()&&"https://"==l.substr(0,8).toLowerCase()||(l="http://"+l),a.push(l)}}a.length>0&&(this.detailImgs=a,n("log",a," at pages\\common\\goods-detail.vue:734"))}},_getData:function(e){var o=this;n("log",this.getPhone()," at pages\\common\\goods-detail.vue:754"),this.phone||t.showToast({title:"未登录",icon:"none"}),t.showLoading({title:"正在玩命加载..."}),n("log",Number(this.getRelationId())," at pages\\common\\goods-detail.vue:764"),e=Number(e),n("log",typeof e," at pages\\common\\goods-detail.vue:766"),n("log",e," at pages\\common\\goods-detail.vue:767");var i=Promise.all([(0,a.getGoodDetail)(e,Number(this.getRelationId())),(0,a.getMaterialItem)(e)]);i.then((function(e){if(o.good={},e.length>0){n("log","商品详情1"," at pages\\common\\goods-detail.vue:777"),n("log",JSON.stringify(e[0])," at pages\\common\\goods-detail.vue:778"),200!=e[0].code&&(t.showToast({title:e[0].msg,icon:"none"}),setTimeout((function(){t.navigateBack({delta:1})}),3e3)),o.good=e[0].data,o.good.small_images=o.good.item_info.small_images.string,o.good.yj=(o.qhj*(o.good.max_commission_rate/100)*.4).toFixed(2),o.recommend=e[1].result;var i=new Date;i.setDate(i.getDate()-2);var a=i.format("yyyy-MM-dd hh:mm:ss");o.insert_collect({item_id:o.good.item_info.num_iid,user_id:t.getStorageSync("user").id,pict_url:o.good.item_info.pict_url,title:o.good.item_info.title,price:o.qhj,create_date:a})}})),setTimeout((function(){t.hideLoading()}),1e3)},_getDetailImg:function(t){for(var e="",o=/<[^>]*>|<\/[^>]*>/gm,n=t.length,i=0;i<n;i++)-1!=t[i].indexOf("<txt>")?e+="":e+="<img src='https://"+t[i].replace(o,"")+"' style='width:100%;max-width:100%' />";return e},_getGoodDetail:function(e,o){var i=this,s=(0,a.getGoodDetail)(e,o);t.showLoading({title:"加载中...",mask:!0}),s.then((function(e){t.hideLoading(),200==e.code?(i.good=e.result,n("log","sp",i.good," at pages\\common\\goods-detail.vue:836")):t.showToast({title:"查无此商品",icon:"none"})})),setTimeout((function(){t.hideLoading()}),1e3)},_getRecommend:function(){var t=this,e=(0,a.getGoodsList)({page:0,type:"",screen:"",jg:""});e.then((function(e){200==e.code&&(t.recommend=e.result)}))},back:function(){t.navigateBack({delta:1})},_onscroll:function(t){var e=t.target||t.srcElement;this.nowScrollTop=e.scrollTop},go:function(t){t||window.event;var e=t.target||t.srcElement;e.offsetLeft<190&&e.offsetLeft>150?(this.scrolltop=this.nowScrollTop,this.$nextTick((function(){this.scrolltop=0,this.isactive=!0}))):e.offsetLeft<240&&e.offsetLeft>190&&(n("log","2",this.scrolltop," at pages\\common\\goods-detail.vue:889"),this.scrolltop=this.nowScrollTop,this.$nextTick((function(){this.scrolltop=555,this.isactive=!1})))}}};e.default=x}).call(this,o("6e42")["default"],o("0de9")["default"])},"4faf":function(t,e,o){"use strict";(function(t){o("00a9"),o("921b");n(o("66fd"));var e=n(o("747f"));function n(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,o("6e42")["createPage"])},"747f":function(t,e,o){"use strict";o.r(e);var n=o("131f"),i=o("ad59");for(var a in i)"default"!==a&&function(t){o.d(e,t,(function(){return i[t]}))}(a);o("fda4");var s,c=o("f0c5"),l=Object(c["a"])(i["default"],n["b"],n["c"],!1,null,"b938fb80",null,!1,n["a"],s);e["default"]=l.exports},ad59:function(t,e,o){"use strict";o.r(e);var n=o("2b95"),i=o.n(n);for(var a in n)"default"!==a&&function(t){o.d(e,t,(function(){return n[t]}))}(a);e["default"]=i.a},ecad:function(t,e,o){},fda4:function(t,e,o){"use strict";var n=o("ecad"),i=o.n(n);i.a}},[["4faf","common/runtime","common/vendor"]]]);